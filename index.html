<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Poster - Cedars Sinai</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .modal-animate {
            animation: fadeIn 0.2s ease-out forwards;
        }
        .term {
            border-bottom: 2px dotted #60a5fa;
            cursor: help;
        }
        .term:hover {
            background-color: #dbeafe;
            color: #1e40af;
        }
        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0 rgba(250, 204, 21, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(250, 204, 21, 0); }
            100% { box-shadow: 0 0 0 0 rgba(250, 204, 21, 0); }
        }
        .tour-highlight {
            animation: pulse-ring 2s infinite;
            border-color: #facc15 !important;
            border-width: 2px;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-900 font-sans min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 shadow-lg relative">
        <!-- Language Selector (Top Right) -->
        <div class="absolute top-4 right-4 z-20">
            <select id="lang-select" onchange="changeLanguage(this.value)" 
                    class="bg-blue-900 text-white text-xs py-1 px-2 rounded border border-blue-400 focus:outline-none focus:border-white">
                <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
            </select>
        </div>

        <div class="max-w-7xl mx-auto flex flex-col md:flex-row gap-6 items-start md:items-center mt-6 md:mt-0">
            <!-- Logo -->
            <div class="hidden md:flex flex-col items-center justify-center w-24 h-24 bg-white/10 rounded-full border-2 border-white/20 shrink-0">
                <div class="text-3xl font-bold">CS</div>
                <div class="text-[0.6rem] uppercase tracking-wider">Cedars Sinai</div>
            </div>

            <div class="flex-1 w-full">
                <h1 id="header-title" class="text-2xl md:text-3xl lg:text-4xl font-extrabold leading-tight mb-3">
                    Cyanobacteria-derived RNA aptamer supports prostate cancer hormone sensitivity
                </h1>
                <div class="text-sm md:text-base text-blue-100 font-light space-y-1">
                    <p><strong id="label-authors">Authors:</strong> Carlos D. Cruz-HernÃ¡ndezÂ¹, Bethany SmithÂ¹, Sandrine BilletÂ¹, Manish ThiruvalluvanÂ¹, et al.</p>
                    <p class="opacity-80 text-xs md:text-sm">1. Department of Medicine, Cedars-Sinai Medical Center, Los Angeles, CA 90048</p>
                </div>

                <!-- Action Buttons -->
                <div class="mt-5 flex flex-wrap items-center gap-4">
                    <button onclick="toggleTour()" id="tour-btn"
                            class="inline-flex items-center gap-2 bg-yellow-400 hover:bg-yellow-300 text-yellow-900 px-4 py-2 rounded-lg text-sm font-bold shadow-md transition-all hover:scale-105 border border-yellow-500">
                        <i data-lucide="headphones" class="w-4 h-4"></i> <span id="btn-tour">Start Audio Tour</span>
                    </button>

                    <div class="h-6 w-px bg-blue-400/50 hidden sm:block"></div>

                    <a href="https://pubmed.ncbi.nlm.nih.gov/40293223/" target="_blank" rel="noopener noreferrer" 
                       class="inline-flex items-center gap-2 bg-white text-blue-900 hover:bg-blue-50 px-4 py-2 rounded-lg text-sm font-bold shadow-sm transition-all hover:scale-105">
                        <i data-lucide="external-link" class="w-4 h-4"></i> <span id="btn-read">Read Paper</span>
                    </a>
                    <a href="images/poster-annotated.jpg" download="poster-annotated.jpg" 
                       class="inline-flex items-center gap-2 bg-blue-900/50 hover:bg-blue-900/70 text-white px-4 py-2 rounded-lg text-sm font-medium border border-blue-400/30 transition-all hover:border-blue-300">
                        <i data-lucide="download" class="w-4 h-4"></i> <span id="btn-save">Save Poster</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 max-w-[1600px] mx-auto w-full p-4 md:p-6 lg:p-8">

        <!-- Graphical Abstract -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
            <div class="flex items-center justify-between mb-4 border-b border-slate-100 pb-2">
                <div class="flex items-center gap-2">
                    <i data-lucide="zap" class="text-blue-600 w-5 h-5"></i>
                    <h2 id="ga-title" class="text-lg font-bold text-slate-800">Study Overview (Graphical Abstract)</h2>
                </div>
                <div class="text-xs text-slate-400 flex items-center gap-1">
                    <i data-lucide="mouse-pointer-click" class="w-3 h-3"></i>
                    <span id="ga-hint">Click icons to view details</span>
                </div>
            </div>
            
            <div class="flex flex-col md:flex-row items-center justify-around gap-6 text-center">
                <!-- GA Steps (Static Icons, Dynamic Text) -->
                <div onclick="openModal('fig1')" class="flex flex-col items-center group cursor-pointer relative transition-transform hover:scale-105">
                    <div class="w-20 h-20 bg-green-50 border-2 border-green-100 rounded-full flex items-center justify-center mb-3 group-hover:border-green-400 group-hover:shadow-md transition-all shadow-sm">
                        <i data-lucide="microscope" class="w-8 h-8 text-green-600"></i>
                    </div>
                    <p id="ga-step1" class="font-bold text-sm text-slate-700 group-hover:text-blue-700">Cyanobacteria</p>
                    <p class="text-xs text-slate-500 italic">(S. elongatus)</p>
                </div>
                
                <i data-lucide="arrow-right" class="hidden md:block text-slate-300 w-8 h-8"></i>
                <i data-lucide="arrow-down" class="md:hidden text-slate-300 w-8 h-8"></i>

                <div onclick="openModal('fig2')" class="flex flex-col items-center group cursor-pointer relative transition-transform hover:scale-105">
                    <div class="w-20 h-20 bg-blue-50 border-2 border-blue-100 rounded-full flex items-center justify-center mb-3 group-hover:border-blue-400 group-hover:shadow-md transition-all shadow-sm">
                        <i data-lucide="dna" class="w-8 h-8 text-blue-600"></i>
                    </div>
                    <p id="ga-step2" class="font-bold text-sm text-slate-700 group-hover:text-blue-700">RNA Aptamer</p>
                    <p class="text-xs text-slate-500 italic">56merA15</p>
                </div>

                <i data-lucide="arrow-right" class="hidden md:block text-slate-300 w-8 h-8"></i>
                <i data-lucide="arrow-down" class="md:hidden text-slate-300 w-8 h-8"></i>

                <div onclick="openModal('fig3')" class="flex flex-col items-center group cursor-pointer relative transition-transform hover:scale-105">
                     <div class="bg-slate-50 border-2 border-slate-200 rounded-lg p-3 w-40 text-left shadow-inner group-hover:border-orange-300 group-hover:bg-orange-50">
                       <div class="flex items-center gap-2 mb-2 pb-1 border-b border-slate-200 group-hover:border-orange-200">
                          <i data-lucide="activity" class="w-3 h-3 text-orange-500"></i>
                          <span id="ga-mech-title" class="text-xs font-bold text-slate-700">Mechanism</span>
                       </div>
                       <ul id="ga-mech-list" class="text-[11px] text-slate-600 space-y-1">
                         <li>â€¢ Binds L-Gln</li>
                         <li>â€¢ Activates GLS</li>
                         <li>â€¢ Depletes L-Gln</li>
                       </ul>
                    </div>
                </div>

                <i data-lucide="arrow-right" class="hidden md:block text-slate-300 w-8 h-8"></i>
                <i data-lucide="arrow-down" class="md:hidden text-slate-300 w-8 h-8"></i>

                <div onclick="openModal('fig5')" class="flex flex-col items-center group cursor-pointer relative transition-transform hover:scale-105">
                    <div class="w-20 h-20 bg-red-50 border-2 border-red-100 rounded-full flex items-center justify-center mb-3 group-hover:border-red-400 group-hover:shadow-md transition-all shadow-sm">
                        <i data-lucide="target" class="w-8 h-8 text-red-600"></i>
                    </div>
                    <p id="ga-step3" class="font-bold text-sm text-slate-700 group-hover:text-blue-700">Tumor Suppression</p>
                    <p id="ga-step3-sub" class="text-xs text-slate-500 italic">Sensitivity Restored</p>
                </div>
            </div>
        </div>

        <!-- Poster Grid -->
        <div id="poster-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 h-full auto-rows-min">
            <!-- JS Injected -->
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-200 p-4 text-center text-slate-500 text-xs">
        <p id="footer-text">Interactive Poster Digital Twin â€¢ Created for Enhanced Accessibility</p>
    </footer>

    <!-- Modal -->
    <div id="modal-backdrop" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm hidden" onclick="closeModal()">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden modal-animate" onclick="event.stopPropagation()">
            <div class="p-4 bg-blue-700 text-white flex justify-between items-center shrink-0">
                <div class="flex items-center gap-2">
                    <div id="modal-icon-container"></div>
                    <h2 id="modal-title" class="text-xl font-bold truncate">Title</h2>
                </div>
                <div class="flex items-center gap-2">
                    <button onclick="stopSpeaking()" class="p-1 hover:bg-white/20 rounded-full transition-colors mr-2 text-white/70 hover:text-white" title="Stop Audio">
                        <i data-lucide="volume-x" class="w-5 h-5"></i>
                    </button>
                    <button onclick="closeModal()" class="p-1 hover:bg-white/20 rounded-full transition-colors">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
            <div id="modal-content" class="p-6 overflow-y-auto grow prose prose-blue max-w-none"></div>
            <div class="p-4 border-t bg-gray-50 text-right shrink-0">
                <button onclick="closeModal()" id="btn-close-modal" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg text-sm font-medium transition-colors">
                    Close Detail
                </button>
            </div>
        </div>
    </div>

    <!-- Tooltip -->
    <div id="tooltip" class="fixed hidden z-[60] max-w-xs bg-slate-800 text-white text-xs rounded shadow-xl p-3 pointer-events-none animate-in fade-in zoom-in duration-150">
        <div id="tooltip-title" class="font-bold mb-1 border-b border-slate-600 pb-1 text-blue-200"></div>
        <div id="tooltip-desc" class="leading-relaxed"></div>
    </div>

    <script>
        // --- TRANSLATION DATA ---
        const LANGUAGES = {
            en: {
                title: "Cyanobacteria-derived RNA aptamer supports prostate cancer hormone sensitivity",
                authors: "Authors:",
                btnTour: "Start Audio Tour",
                btnStopTour: "Stop Tour",
                btnRead: "Read Paper",
                btnSave: "Save Poster",
                gaTitle: "Study Overview (Graphical Abstract)",
                gaHint: "Click icons to view details",
                gaStep1: "Cyanobacteria",
                gaStep2: "RNA Aptamer",
                gaMechTitle: "Mechanism",
                gaMechList: "<li>â€¢ Binds L-Gln</li><li>â€¢ Activates GLS</li><li>â€¢ Depletes L-Gln</li>",
                gaStep3: "Tumor Suppression",
                gaStep3Sub: "Sensitivity Restored",
                clickToRead: "Click to Read",
                closeDetail: "Close Detail",
                footer: "Interactive Poster Digital Twin â€¢ Created for Enhanced Accessibility",
                welcomeSpeech: "Welcome to the interactive poster session. This study explores how a cyanobacteria-derived RNA aptamer supports prostate cancer hormone sensitivity. Please click on the Abstract to begin.",
                nextStep: "Please continue by clicking on",
                tourEnd: "You have reached the end of the tour. Thank you for viewing.",
                missingImg: "Image not found",
                placeImg: "Please ensure file exists in images/ folder"
            },
            es: {
                title: "El aptÃ¡mero de ARN derivado de cianobacterias apoya la sensibilidad hormonal del cÃ¡ncer de prÃ³stata",
                authors: "Autores:",
                btnTour: "Iniciar Audio",
                btnStopTour: "Detener",
                btnRead: "Leer ArtÃ­culo",
                btnSave: "Guardar",
                gaTitle: "Resumen del Estudio (GrÃ¡fico)",
                gaHint: "Haga clic para ver detalles",
                gaStep1: "Cianobacterias",
                gaStep2: "AptÃ¡mero de ARN",
                gaMechTitle: "Mecanismo",
                gaMechList: "<li>â€¢ Une L-Gln</li><li>â€¢ Activa GLS</li><li>â€¢ Agota L-Gln</li>",
                gaStep3: "SupresiÃ³n Tumoral",
                gaStep3Sub: "Sensibilidad Restaurada",
                clickToRead: "Clic para Leer",
                closeDetail: "Cerrar Detalle",
                footer: "PÃ³ster Interactivo â€¢ Creado para Accesibilidad",
                welcomeSpeech: "Bienvenido a la sesiÃ³n de pÃ³sters interactivos. Este estudio explora cÃ³mo un aptÃ¡mero de ARN derivado de cianobacterias apoya la sensibilidad hormonal del cÃ¡ncer de prÃ³stata. Haga clic en el Resumen para comenzar.",
                nextStep: "Por favor continÃºe haciendo clic en",
                tourEnd: "Ha llegado al final del recorrido. Gracias por ver.",
                missingImg: "Imagen no encontrada",
                placeImg: "AsegÃºrese de que el archivo exista en la carpeta images/"
            },
            de: {
                title: "Cyanobakterien-abgeleitetes RNA-Aptamer unterstÃ¼tzt die HormonsensitivitÃ¤t bei Prostatakrebs",
                authors: "Autoren:",
                btnTour: "Audio-Tour Starten",
                btnStopTour: "Tour Stoppen",
                btnRead: "Papier Lesen",
                btnSave: "Speichern",
                gaTitle: "StudienÃ¼bersicht",
                gaHint: "Klicken fÃ¼r Details",
                gaStep1: "Cyanobakterien",
                gaStep2: "RNA-Aptamer",
                gaMechTitle: "Mechanismus",
                gaMechList: "<li>â€¢ Bindet L-Gln</li><li>â€¢ Aktiviert GLS</li><li>â€¢ ErschÃ¶pft L-Gln</li>",
                gaStep3: "Tumorsuppression",
                gaStep3Sub: "SensitivitÃ¤t Wiederhergestellt",
                clickToRead: "Klicken zum Lesen",
                closeDetail: "SchlieÃŸen",
                footer: "Interaktives Poster â€¢ Erstellt fÃ¼r Barrierefreiheit",
                welcomeSpeech: "Willkommen zur interaktiven Postersession. Diese Studie untersucht, wie ein RNA-Aptamer die HormonsensitivitÃ¤t bei Prostatakrebs unterstÃ¼tzt. Bitte klicken Sie auf die Zusammenfassung, um zu beginnen.",
                nextStep: "Bitte fahren Sie fort, indem Sie auf klicken",
                tourEnd: "Sie haben das Ende der Tour erreicht. Danke fÃ¼rs Zuschauen.",
                missingImg: "Bild nicht gefunden",
                placeImg: "Datei muss im Ordner images/ sein"
            },
            fr: {
                title: "L'aptamÃ¨re d'ARN dÃ©rivÃ© de cyanobactÃ©ries soutient la sensibilitÃ© hormonale du cancer de la prostate",
                authors: "Auteurs:",
                btnTour: "Visite Audio",
                btnStopTour: "ArrÃªter",
                btnRead: "Lire l'article",
                btnSave: "Sauvegarder",
                gaTitle: "AperÃ§u de l'Ã©tude",
                gaHint: "Cliquez pour les dÃ©tails",
                gaStep1: "CyanobactÃ©ries",
                gaStep2: "AptamÃ¨re ARN",
                gaMechTitle: "MÃ©canisme",
                gaMechList: "<li>â€¢ Lie L-Gln</li><li>â€¢ Active GLS</li><li>â€¢ Ã‰puise L-Gln</li>",
                gaStep3: "Suppression Tumorale",
                gaStep3Sub: "SensibilitÃ© RestaurÃ©e",
                clickToRead: "Cliquer pour Lire",
                closeDetail: "Fermer",
                footer: "Poster Interactif â€¢ CrÃ©Ã© pour l'accessibilitÃ©",
                welcomeSpeech: "Bienvenue Ã  la session de posters interactifs. Cette Ã©tude explore comment un aptamÃ¨re d'ARN soutient la sensibilitÃ© hormonale du cancer de la prostate. Cliquez sur le RÃ©sumÃ© pour commencer.",
                nextStep: "Veuillez continuer en cliquant sur",
                tourEnd: "Vous avez atteint la fin de la visite. Merci.",
                missingImg: "Image non trouvÃ©e",
                placeImg: "VÃ©rifiez le dossier images/"
            },
            zh: {
                title: "è“ç»†èŒæ¥æºçš„RNAé€‚é…ä½“æ”¯æŒå‰åˆ—è…ºç™Œæ¿€ç´ æ•æ„Ÿæ€§",
                authors: "ä½œè€…:",
                btnTour: "å¼€å§‹éŸ³é¢‘å¯¼è§ˆ",
                btnStopTour: "åœæ­¢å¯¼è§ˆ",
                btnRead: "é˜…è¯»è®ºæ–‡",
                btnSave: "ä¿å­˜æµ·æŠ¥",
                gaTitle: "ç ”ç©¶æ¦‚è§ˆ",
                gaHint: "ç‚¹å‡»å›¾æ ‡æŸ¥çœ‹è¯¦æƒ…",
                gaStep1: "è“ç»†èŒ",
                gaStep2: "RNAé€‚é…ä½“",
                gaMechTitle: "æœºåˆ¶",
                gaMechList: "<li>â€¢ ç»“åˆ L-Gln</li><li>â€¢ æ¿€æ´» GLS</li><li>â€¢ æ¶ˆè€— L-Gln</li>",
                gaStep3: "è‚¿ç˜¤æŠ‘åˆ¶",
                gaStep3Sub: "æ•æ„Ÿæ€§æ¢å¤",
                clickToRead: "ç‚¹å‡»é˜…è¯»",
                closeDetail: "å…³é—­è¯¦æƒ…",
                footer: "äº¤äº’å¼æµ·æŠ¥æ•°å­—å­ªç”Ÿ â€¢ ä¸ºå¢å¼ºå¯è®¿é—®æ€§è€Œåˆ›å»º",
                welcomeSpeech: "æ¬¢è¿å‚åŠ äº¤äº’å¼æµ·æŠ¥ä¼šè®®ã€‚è¿™é¡¹ç ”ç©¶æ¢è®¨äº†è“ç»†èŒæ¥æºçš„RNAé€‚é…ä½“å¦‚ä½•æ”¯æŒå‰åˆ—è…ºç™Œæ¿€ç´ æ•æ„Ÿæ€§ã€‚è¯·ç‚¹å‡»æ‘˜è¦å¼€å§‹ã€‚",
                nextStep: "è¯·ç»§ç»­ç‚¹å‡»",
                tourEnd: "æ‚¨å·²åˆ°è¾¾å¯¼è§ˆç»ˆç‚¹ã€‚è°¢è°¢è§‚çœ‹ã€‚",
                missingImg: "æœªæ‰¾åˆ°å›¾ç‰‡",
                placeImg: "è¯·ç¡®ä¿æ–‡ä»¶åœ¨ images/ æ–‡ä»¶å¤¹ä¸­"
            },
            ja: {
                title: "ã‚·ã‚¢ãƒãƒã‚¯ãƒ†ãƒªã‚¢ç”±æ¥RNAã‚¢ãƒ—ã‚¿ãƒãƒ¼ã¯å‰ç«‹è…ºç™Œã®ãƒ›ãƒ«ãƒ¢ãƒ³æ„Ÿå—æ€§ã‚’æ”¯æŒã™ã‚‹",
                authors: "è‘—è€…:",
                btnTour: "éŸ³å£°ãƒ„ã‚¢ãƒ¼é–‹å§‹",
                btnStopTour: "ãƒ„ã‚¢ãƒ¼åœæ­¢",
                btnRead: "è«–æ–‡ã‚’èª­ã‚€",
                btnSave: "ãƒã‚¹ã‚¿ãƒ¼ä¿å­˜",
                gaTitle: "ç ”ç©¶æ¦‚è¦",
                gaHint: "è©³ç´°ã‚’è¦‹ã‚‹ã«ã¯ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯",
                gaStep1: "ã‚·ã‚¢ãƒãƒã‚¯ãƒ†ãƒªã‚¢",
                gaStep2: "RNAã‚¢ãƒ—ã‚¿ãƒãƒ¼",
                gaMechTitle: "ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ",
                gaMechList: "<li>â€¢ L-Glnçµåˆ</li><li>â€¢ GLSæ´»æ€§åŒ–</li><li>â€¢ L-Glnæ¯æ¸‡</li>",
                gaStep3: "è…«ç˜æŠ‘åˆ¶",
                gaStep3Sub: "æ„Ÿå—æ€§å›å¾©",
                clickToRead: "ã‚¯ãƒªãƒƒã‚¯ã—ã¦èª­ã‚€",
                closeDetail: "é–‰ã˜ã‚‹",
                footer: "ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒã‚¹ã‚¿ãƒ¼ â€¢ ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å‘ä¸Šã®ãŸã‚ã«ä½œæˆ",
                welcomeSpeech: "ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒã‚¹ã‚¿ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¸ã‚ˆã†ã“ãã€‚ã“ã®ç ”ç©¶ã¯ã€RNAã‚¢ãƒ—ã‚¿ãƒãƒ¼ãŒå‰ç«‹è…ºç™Œã®ãƒ›ãƒ«ãƒ¢ãƒ³æ„Ÿå—æ€§ã‚’ã©ã®ã‚ˆã†ã«æ”¯æŒã™ã‚‹ã‹ã‚’æ¢æ±‚ã—ã¾ã™ã€‚è¦ç´„ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å§‹ã‚ã¦ãã ã•ã„ã€‚",
                nextStep: "æ¬¡ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼š",
                tourEnd: "ãƒ„ã‚¢ãƒ¼ã®çµ‚ã‚ã‚Šã«é”ã—ã¾ã—ãŸã€‚ã”è¦§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚",
                missingImg: "ç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“",
                placeImg: "images/ãƒ•ã‚©ãƒ«ãƒ€ã‚’ç¢ºèªã—ã¦ãã ã•ã„"
            }
        };

        // --- CONTENT DATA (Structured for Localization) ---
        const CONTENT = {
            abstract: {
                en: { title: "Abstract", summary: "Prostate adenocarcinoma (PCa) resistance to androgen receptor (AR) signaling inhibitor therapy is associated with elevated glutamine...", text: "<p>Prostate Adenocarcinoma (PCa) resistance to Androgen receptor (AR) signaling inhibitor therapy is associated with elevated Glutamine (L-Gln). Key Finding: The optimized Aptamer depleted L-Gln from PCa cells by both L-Gln sequestration and the recruitment of extracellular Glutaminase activity.</p>" },
                es: { title: "Resumen", summary: "La resistencia del adenocarcinoma de prÃ³stata (CaP) a la terapia inhibidora del receptor de andrÃ³genos (AR) estÃ¡ asociada con glutamina elevada...", text: "<p>La resistencia del Adenocarcinoma de PrÃ³stata (CaP) a la terapia inhibidora del receptor de andrÃ³genos (AR) estÃ¡ asociada con Glutamina elevada. Hallazgo Clave: El AptÃ¡mero optimizado agotÃ³ la L-Gln de las cÃ©lulas de CaP mediante el secuestro de L-Gln y el reclutamiento de actividad de Glutaminasa extracelular.</p>" },
                de: { title: "Zusammenfassung", summary: "Die Resistenz des Prostata-Adenokarzinoms (PCa) gegen Androgenrezeptor (AR)-Signalweg-Inhibitoren ist mit erhÃ¶htem Glutamin assoziiert...", text: "<p>Die Resistenz des Prostata-Adenokarzinoms ist mit erhÃ¶htem Glutamin assoziiert. Hauptergebnis: Das optimierte Aptamer entzog PCa-Zellen L-Gln.</p>" },
                fr: { title: "RÃ©sumÃ©", summary: "La rÃ©sistance de l'adÃ©nocarcinome de la prostate (CaP) au traitement inhibiteur du rÃ©cepteur des androgÃ¨nes (RA) est associÃ©e Ã  une glutamine Ã©levÃ©e...", text: "<p>La rÃ©sistance de l'adÃ©nocarcinome de la prostate est associÃ©e Ã  une glutamine Ã©levÃ©e. RÃ©sultat clÃ© : L'aptamÃ¨re optimisÃ© a Ã©puisÃ© la L-Gln des cellules.</p>" },
                zh: { title: "æ‘˜è¦", summary: "å‰åˆ—è…ºè…ºç™Œ (PCa) å¯¹é›„æ¿€ç´ å—ä½“ (AR) ä¿¡å·æŠ‘åˆ¶å‰‚æ²»ç–—çš„è€è¯æ€§ä¸è°·æ°¨é…°èƒºå‡é«˜æœ‰å…³...", text: "<p>å‰åˆ—è…ºè…ºç™Œå¯¹é›„æ¿€ç´ å—ä½“ä¿¡å·æŠ‘åˆ¶å‰‚æ²»ç–—çš„è€è¯æ€§ä¸è°·æ°¨é…°èƒºå‡é«˜æœ‰å…³ã€‚ä¸»è¦å‘ç°ï¼šä¼˜åŒ–çš„é€‚é…ä½“è€—å°½äº† PCa ç»†èƒä¸­çš„ L-Glnã€‚</p>" },
                ja: { title: "è¦ç´„", summary: "å‰ç«‹è…ºè…ºç™Œï¼ˆPCaï¼‰ã®ã‚¢ãƒ³ãƒ‰ãƒ­ã‚²ãƒ³å—å®¹ä½“ï¼ˆARï¼‰ã‚·ã‚°ãƒŠãƒ«é˜»å®³ç™‚æ³•ã«å¯¾ã™ã‚‹æŠµæŠ—æ€§ã¯ã€ã‚°ãƒ«ã‚¿ãƒŸãƒ³ä¸Šæ˜‡ã¨é–¢é€£ã—ã¦ã„ã‚‹...", text: "<p>å‰ç«‹è…ºè…ºç™Œã®æŠµæŠ—æ€§ã¯ã€ã‚°ãƒ«ã‚¿ãƒŸãƒ³ä¸Šæ˜‡ã¨é–¢é€£ã—ã¦ã„ã¾ã™ã€‚ä¸»ãªç™ºè¦‹ï¼šæœ€é©åŒ–ã•ã‚ŒãŸã‚¢ãƒ—ã‚¿ãƒãƒ¼ã¯ã€PCaç´°èƒã‹ã‚‰L-Glnã‚’æ¯æ¸‡ã•ã›ã¾ã—ãŸã€‚</p>" }
            },
            intro: {
                en: { title: "Introduction", summary: "Prostate cancer therapy resistance is a significant factor leading to cancer mortality...", text: "<p>Prostate cancer therapy resistance is a significant factor leading to cancer mortality. Hypothesis: We reasoned that interrupting L-Gln uptake by its extracellular depletion in a tumor-specific manner can be a therapeutic strategy.</p>" },
                es: { title: "IntroducciÃ³n", summary: "La resistencia a la terapia del cÃ¡ncer de prÃ³stata es un factor significativo...", text: "<p>La resistencia a la terapia del cÃ¡ncer de prÃ³stata es un factor significativo que conduce a la mortalidad. HipÃ³tesis: Razonamos que interrumpir la captaciÃ³n de L-Gln mediante su agotamiento extracelular puede ser una estrategia terapÃ©utica.</p>" },
                de: { title: "Einleitung", summary: "Therapieresistenz bei Prostatakrebs ist ein bedeutender Faktor...", text: "<p>Therapieresistenz bei Prostatakrebs ist ein bedeutender Faktor. Hypothese: Unterbrechung der L-Gln-Aufnahme.</p>" },
                fr: { title: "Introduction", summary: "La rÃ©sistance au traitement du cancer de la prostate est un facteur important...", text: "<p>La rÃ©sistance au traitement du cancer de la prostate est un facteur important. HypothÃ¨se : Interrompre l'absorption de L-Gln.</p>" },
                zh: { title: "ä»‹ç»", summary: "å‰åˆ—è…ºç™Œæ²»ç–—è€è¯æ€§æ˜¯å¯¼è‡´ç™Œç—‡æ­»äº¡çš„é‡è¦å› ç´ ...", text: "<p>å‰åˆ—è…ºç™Œæ²»ç–—è€è¯æ€§æ˜¯å¯¼è‡´ç™Œç—‡æ­»äº¡çš„é‡è¦å› ç´ ã€‚å‡è®¾ï¼šæˆ‘ä»¬æ¨æ–­ä¸­æ–­ L-Gln æ‘„å–å¯ä»¥ä½œä¸ºä¸€ç§æ²»ç–—ç­–ç•¥ã€‚</p>" },
                ja: { title: "åºè«–", summary: "å‰ç«‹è…ºç™Œæ²»ç™‚æŠµæŠ—æ€§ã¯ã€ç™Œæ­»äº¡ã®é‡è¦ãªè¦å› ã§ã™...", text: "<p>å‰ç«‹è…ºç™Œæ²»ç™‚æŠµæŠ—æ€§ã¯ã€ç™Œæ­»äº¡ã®é‡è¦ãªè¦å› ã§ã™ã€‚ä»®èª¬ï¼šL-Glnå–ã‚Šè¾¼ã¿ã‚’é®æ–­ã™ã‚‹ã“ã¨ãŒæ²»ç™‚æˆ¦ç•¥ã«ãªã‚Šå¾—ã‚‹ã¨æ¨è«–ã—ã¾ã—ãŸã€‚</p>" }
            },
            fig1: {
                en: { title: "Fig 1: Aptamer Optimization", summary: "Optimization of the glnA aptamer through in silico modifications.", text: "<p>(A) Sunburst plot. (B) Secondary structure. (C) 3D structure of the 56mer bound to L-Gln.</p>" },
                es: { title: "Fig 1: OptimizaciÃ³n del AptÃ¡mero", summary: "OptimizaciÃ³n del aptÃ¡mero glnA mediante modificaciones in silico.", text: "<p>(A) GrÃ¡fico Sunburst. (B) Estructura secundaria. (C) Estructura 3D del 56mer unido a L-Gln.</p>" },
                de: { title: "Abb 1: Aptamer-Optimierung", summary: "Optimierung des glnA-Aptamers.", text: "<p>(A) Sunburst-Diagramm. (B) SekundÃ¤rstruktur.</p>" },
                fr: { title: "Fig 1: Optimisation de l'aptamÃ¨re", summary: "Optimisation de l'aptamÃ¨re glnA.", text: "<p>(A) Diagramme solaire. (B) Structure secondaire.</p>" },
                zh: { title: "å›¾ 1: é€‚é…ä½“ä¼˜åŒ–", summary: "é€šè¿‡è®¡ç®—æœºæ¨¡æ‹Ÿä¿®æ”¹ä¼˜åŒ– glnA é€‚é…ä½“ã€‚", text: "<p>(A) æ—­æ—¥å›¾ã€‚(B) äºŒçº§ç»“æ„ã€‚</p>" },
                ja: { title: "å›³ 1: ã‚¢ãƒ—ã‚¿ãƒãƒ¼æœ€é©åŒ–", summary: "ã‚¤ãƒ³ã‚·ãƒªã‚³ä¿®é£¾ã«ã‚ˆã‚‹glnAã‚¢ãƒ—ã‚¿ãƒãƒ¼ã®æœ€é©åŒ–ã€‚", text: "<p>(A) ã‚µãƒ³ãƒãƒ¼ã‚¹ãƒˆå›³ã€‚(B) äºŒæ¬¡æ§‹é€ ã€‚</p>" }
            },
            fig2: {
                en: { title: "Fig 2: L-Gln Depletion", summary: "Characterization of the aptamer's ability to deplete L-Gln.", text: "<p>Characterization of L-Gln binding. Kd was calculated to be 24.3 nM.</p>" },
                es: { title: "Fig 2: Agotamiento de L-Gln", summary: "CaracterizaciÃ³n de la capacidad del aptÃ¡mero para agotar L-Gln.", text: "<p>CaracterizaciÃ³n de la uniÃ³n a L-Gln. La Kd se calculÃ³ en 24.3 nM.</p>" },
                de: { title: "Abb 2: L-Gln-Verarmung", summary: "Charakterisierung der L-Gln-Verarmung.", text: "<p>Charakterisierung der Bindung. Kd betrug 24.3 nM.</p>" },
                fr: { title: "Fig 2: Ã‰puisement de L-Gln", summary: "CaractÃ©risation de l'Ã©puisement.", text: "<p>CaractÃ©risation de la liaison. Kd Ã©tait de 24.3 nM.</p>" },
                zh: { title: "å›¾ 2: L-Gln æ¶ˆè€—", summary: "é€‚é…ä½“æ¶ˆè€— L-Gln èƒ½åŠ›çš„è¡¨å¾ã€‚", text: "<p>L-Gln ç»“åˆè¡¨å¾ã€‚Kd è®¡ç®—ä¸º 24.3 nMã€‚</p>" },
                ja: { title: "å›³ 2: L-Gln æ¯æ¸‡", summary: "L-Glnã‚’æ¯æ¸‡ã•ã›ã‚‹ã‚¢ãƒ—ã‚¿ãƒãƒ¼èƒ½åŠ›ã®ç‰¹æ€§è©•ä¾¡ã€‚", text: "<p>çµåˆã®ç‰¹æ€§è©•ä¾¡ã€‚Kdã¯24.3 nMã¨è¨ˆç®—ã•ã‚Œã¾ã—ãŸã€‚</p>" }
            },
            fig3: {
                en: { title: "Fig 3: GLS Cooperation", summary: "Investigation of cooperation between Glutaminase (GLS) and aptamer.", text: "<p>Interaction enhances enzymatic activity, serving as an allosteric activator for GLS.</p>" },
                es: { title: "Fig 3: CooperaciÃ³n GLS", summary: "InvestigaciÃ³n de la cooperaciÃ³n entre Glutaminasa y el aptÃ¡mero.", text: "<p>La interacciÃ³n mejora la actividad enzimÃ¡tica, sirviendo como activador alostÃ©rico.</p>" },
                de: { title: "Abb 3: GLS-Kooperation", summary: "Untersuchung der Kooperation.", text: "<p>Interaktion verstÃ¤rkt enzymatische AktivitÃ¤t.</p>" },
                fr: { title: "Fig 3: CoopÃ©ration GLS", summary: "Investigation de la coopÃ©ration.", text: "<p>L'interaction amÃ©liore l'activitÃ© enzymatique.</p>" },
                zh: { title: "å›¾ 3: GLS åˆä½œ", summary: "è°·æ°¨é…°èƒºé…¶ (GLS) ä¸é€‚é…ä½“ä¹‹é—´åˆä½œçš„ç ”ç©¶ã€‚", text: "<p>ç›¸äº’ä½œç”¨å¢å¼ºäº†é…¶æ´»æ€§ã€‚</p>" },
                ja: { title: "å›³ 3: GLS å”åŠ›", summary: "ã‚°ãƒ«ã‚¿ãƒŸãƒŠãƒ¼ã‚¼ (GLS) ã¨ã‚¢ãƒ—ã‚¿ãƒãƒ¼é–“ã®å”åŠ›ã®èª¿æŸ»ã€‚", text: "<p>ç›¸äº’ä½œç”¨ã¯é…µç´ æ´»æ€§ã‚’é«˜ã‚ã¾ã™ã€‚</p>" }
            },
            fig4: {
                en: { title: "Fig 4: FGF8 Regulation", summary: "Impact of L-Gln depletion on FGF8 and drug sensitivity.", text: "<p>(A) Seahorse experiment results showing oxygen consumption rates.</p>" },
                es: { title: "Fig 4: RegulaciÃ³n de FGF8", summary: "Impacto del agotamiento de L-Gln en FGF8.", text: "<p>(A) Resultados del experimento Seahorse mostrando tasas de consumo de oxÃ­geno.</p>" },
                de: { title: "Abb 4: FGF8-Regulation", summary: "Auswirkung auf FGF8.", text: "<p>(A) Seahorse-Experiment Ergebnisse.</p>" },
                fr: { title: "Fig 4: RÃ©gulation FGF8", summary: "Impact sur FGF8.", text: "<p>(A) RÃ©sultats de l'expÃ©rience Seahorse.</p>" },
                zh: { title: "å›¾ 4: FGF8 è°ƒèŠ‚", summary: "L-Gln æ¶ˆè€—å¯¹ FGF8 çš„å½±å“ã€‚", text: "<p>(A) Seahorse å®éªŒç»“æœã€‚</p>" },
                ja: { title: "å›³ 4: FGF8 èª¿ç¯€", summary: "L-Gln æ¯æ¸‡ãŒ FGF8 ã«ä¸ãˆã‚‹å½±éŸ¿ã€‚", text: "<p>(A) ã‚·ãƒ¼ãƒ›ãƒ¼ã‚¹å®Ÿé¨“çµæœã€‚</p>" }
            },
            fig5: {
                en: { title: "Fig 5: In Vivo Effect", summary: "Testing efficacy in live models.", text: "<p>L-Gln depletion complements AR inhibition. Surviving cells quantified by trypan blue.</p>" },
                es: { title: "Fig 5: Efecto In Vivo", summary: "Probando eficacia en modelos vivos.", text: "<p>El agotamiento complementa la inhibiciÃ³n de AR. CÃ©lulas supervivientes cuantificadas.</p>" },
                de: { title: "Abb 5: In-vivo-Effekt", summary: "Testen der Wirksamkeit.", text: "<p>Verarmung ergÃ¤nzt AR-Hemmung.</p>" },
                fr: { title: "Fig 5: Effet In Vivo", summary: "Test de l'efficacitÃ©.", text: "<p>L'Ã©puisement complÃ¨te l'inhibition des RA.</p>" },
                zh: { title: "å›¾ 5: ä½“å†…æ•ˆåº”", summary: "åœ¨æ´»ä½“æ¨¡å‹ä¸­æµ‹è¯•åŠŸæ•ˆã€‚", text: "<p>è€—ç«­è¡¥å……äº† AR æŠ‘åˆ¶ã€‚</p>" },
                ja: { title: "å›³ 5: ç”Ÿä½“å†…ã®åŠ¹æœ", summary: "ç”Ÿä½“ãƒ¢ãƒ‡ãƒ«ã§ã®æœ‰åŠ¹æ€§è©¦é¨“ã€‚", text: "<p>æ¯æ¸‡ã¯ARé˜»å®³ã‚’è£œå®Œã—ã¾ã™ã€‚</p>" }
            },
            fig6: {
                en: { title: "Fig 6: Nanoparticles", summary: "Using gold nanoparticles for targeted delivery.", text: "<p>Targeted depletion by 56merA15-AuNP support enzalutamide sensitivity.</p>" },
                es: { title: "Fig 6: NanopartÃ­culas", summary: "Uso de nanopartÃ­culas de oro para entrega dirigida.", text: "<p>El agotamiento dirigido por 56merA15-AuNP apoya la sensibilidad.</p>" },
                de: { title: "Abb 6: Nanopartikel", summary: "Verwendung von Goldnanopartikeln.", text: "<p>Gezielte Verarmung unterstÃ¼tzt SensitivitÃ¤t.</p>" },
                fr: { title: "Fig 6: Nanoparticules", summary: "Utilisation de nanoparticules d'or.", text: "<p>L'Ã©puisement ciblÃ© soutient la sensibilitÃ©.</p>" },
                zh: { title: "å›¾ 6: çº³ç±³ç²’å­", summary: "ä½¿ç”¨é‡‘çº³ç±³ç²’å­è¿›è¡Œé¶å‘é€’é€ã€‚", text: "<p>é¶å‘è€—ç«­æ”¯æŒæ•æ„Ÿæ€§ã€‚</p>" },
                ja: { title: "å›³ 6: ãƒŠãƒç²’å­", summary: "æ¨™çš„é€é”ã®ãŸã‚ã®é‡‘ãƒŠãƒç²’å­ã®ä½¿ç”¨ã€‚", text: "<p>æ¨™çš„æ¯æ¸‡ã¯æ„Ÿå—æ€§ã‚’æ”¯æŒã—ã¾ã™ã€‚</p>" }
            },
            discussion: {
                en: { title: "Discussion", summary: "PCa resistance is a leading cause of mortality...", text: "<p>Our work revealed a novel aptamer with catalytic enhancer properties for L-Gln depletion in coupling glutaminase activity.</p>" },
                es: { title: "DiscusiÃ³n", summary: "La resistencia es una causa principal de mortalidad...", text: "<p>Nuestro trabajo revelÃ³ un nuevo aptÃ¡mero con propiedades potenciadoras catalÃ­ticas para el agotamiento de L-Gln.</p>" },
                de: { title: "Diskussion", summary: "Resistenz ist eine Hauptursache...", text: "<p>Unsere Arbeit enthÃ¼llte ein neuartiges Aptamer.</p>" },
                fr: { title: "Discussion", summary: "La rÃ©sistance est une cause majeure...", text: "<p>Notre travail a rÃ©vÃ©lÃ© un nouvel aptamÃ¨re.</p>" },
                zh: { title: "è®¨è®º", summary: "è€è¯æ€§æ˜¯æ­»äº¡çš„ä¸»è¦åŸå› ...", text: "<p>æˆ‘ä»¬çš„å·¥ä½œæ­ç¤ºäº†ä¸€ç§æ–°å‹é€‚é…ä½“ã€‚</p>" },
                ja: { title: "è€ƒå¯Ÿ", summary: "æŠµæŠ—æ€§ã¯æ­»äº¡ã®ä¸»ãªåŸå› ã§ã™...", text: "<p>ç§ãŸã¡ã®ç ”ç©¶ã¯ã€æ–°ã—ã„ã‚¢ãƒ—ã‚¿ãƒãƒ¼ã‚’æ˜ã‚‰ã‹ã«ã—ã¾ã—ãŸã€‚</p>" }
            },
            references: {
                en: { title: "References", summary: "Key citations.", text: "<ol class='list-decimal pl-5'><li>Siegel RL et al.</li><li>Xu L et al.</li><li>Mishra et al.</li><li>Ames TD et al.</li></ol>" },
                es: { title: "Referencias", summary: "Citas clave.", text: "<ol class='list-decimal pl-5'><li>Siegel RL et al.</li><li>Xu L et al.</li><li>Mishra et al.</li><li>Ames TD et al.</li></ol>" },
                de: { title: "Referenzen", summary: "Wichtige Zitate.", text: "<ol class='list-decimal pl-5'><li>Siegel RL et al.</li><li>Xu L et al.</li></ol>" },
                fr: { title: "RÃ©fÃ©rences", summary: "Citations clÃ©s.", text: "<ol class='list-decimal pl-5'><li>Siegel RL et al.</li><li>Xu L et al.</li></ol>" },
                zh: { title: "å‚è€ƒæ–‡çŒ®", summary: "ä¸»è¦å¼•ç”¨ã€‚", text: "<ol class='list-decimal pl-5'><li>Siegel RL et al.</li><li>Xu L et al.</li></ol>" },
                ja: { title: "å‚è€ƒæ–‡çŒ®", summary: "ä¸»ãªå¼•ç”¨ã€‚", text: "<ol class='list-decimal pl-5'><li>Siegel RL et al.</li><li>Xu L et al.</li></ol>" }
            }
        };

        // --- APP STATE ---
        let currentLang = 'en';
        let isTourActive = false;
        let currentTourIndex = -1;
        const synth = window.speechSynthesis;

        // Image Map to ensure correct image is loaded per ID
        const IMG_MAP = {
            fig1: 'images/fig1.png',
            fig2: 'images/fig2.png',
            fig3: 'images/fig3.png',
            fig4: 'images/fig4.png',
            fig5: 'images/fig5.png',
            fig6: 'images/fig6.png'
        };

        // --- CORE FUNCTIONS ---

        function changeLanguage(lang) {
            currentLang = lang;
            const t = LANGUAGES[lang];

            // 1. Update Static Header & UI
            document.getElementById('header-title').innerText = t.title;
            document.getElementById('label-authors').innerText = t.authors;
            document.getElementById('btn-tour').innerText = isTourActive ? t.btnStopTour : t.btnTour;
            document.getElementById('btn-read').innerText = t.btnRead;
            document.getElementById('btn-save').innerText = t.btnSave;
            document.getElementById('footer-text').innerText = t.footer;
            document.getElementById('btn-close-modal').innerText = t.closeDetail;
            
            // 2. Update Graphical Abstract
            document.getElementById('ga-title').innerText = t.gaTitle;
            document.getElementById('ga-hint').innerText = t.gaHint;
            document.getElementById('ga-step1').innerText = t.gaStep1;
            document.getElementById('ga-step2').innerText = t.gaStep2;
            document.getElementById('ga-mech-title').innerText = t.gaMechTitle;
            document.getElementById('ga-mech-list').innerHTML = t.gaMechList;
            document.getElementById('ga-step3').innerText = t.gaStep3;
            document.getElementById('ga-step3-sub').innerText = t.gaStep3Sub;

            // 3. Re-render Grid
            renderGrid();

            // 4. Close Modal if open (to reset content)
            document.getElementById('modal-backdrop').classList.add('hidden');
        }

        function getImgHtml(id) {
            const src = IMG_MAP[id];
            if (!src) return '';
            
            const t = LANGUAGES[currentLang];
            // SVG Placeholder that looks like a missing image icon
            const fallbackSvg = `data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3crect x='3' y='3' width='18' height='18' rx='2' ry='2'/%3e%3ccircle cx='8.5' cy='8.5' r='1.5'/%3e%3cpolyline points='21 15 16 10 5 21'/%3e%3c/svg%3e`;
            
            return `
            <div class="mb-4 group relative w-full bg-gray-50 border border-gray-200 rounded-lg overflow-hidden flex items-center justify-center min-h-[200px]">
                <img src="${src}" 
                    class="w-full h-auto object-contain cursor-zoom-in"
                    onerror="this.onerror=null; this.src='${fallbackSvg}'; this.className='w-16 h-16 opacity-50 my-8'; this.nextElementSibling.classList.remove('hidden');"
                />
                <div class="hidden absolute bottom-2 left-0 right-0 text-center text-xs text-red-500 bg-red-50 py-1">
                    ${t.missingImg}: ${src}
                </div>
            </div>`;
        }

        function renderGrid() {
            const grid = document.getElementById('poster-grid');
            grid.innerHTML = ''; // Clear existing
            
            const keys = Object.keys(CONTENT);
            const columns = [[], [], [], []];
            
            // Distribute keys into columns
            keys.forEach((key, index) => {
                if(index < 2) columns[0].push(key);
                else if(index < 5) columns[1].push(key);
                else if(index < 7) columns[2].push(key);
                else columns[3].push(key);
            });

            const t = LANGUAGES[currentLang];

            columns.forEach(colKeys => {
                const colDiv = document.createElement('div');
                colDiv.className = 'flex flex-col gap-4';
                
                colKeys.forEach(key => {
                    const data = CONTENT[key][currentLang];
                    const iconMap = { abstract:'file-text', intro:'info', fig1:'microscope', fig2:'activity', fig3:'zap', fig4:'activity', fig5:'microscope', fig6:'target', discussion:'book-open', references:'book' };
                    
                    const card = document.createElement('div');
                    card.id = `card-${key}`;
                    card.className = "group relative bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden cursor-pointer hover:shadow-xl hover:border-blue-400 transition-all duration-300 flex flex-col";
                    card.onclick = () => openModal(key);
                    card.innerHTML = `
                        <div class="bg-blue-900 text-white p-2 px-3 flex justify-between items-center">
                            <h3 class="font-bold text-xs uppercase tracking-wider truncate flex-1">${data.title}</h3>
                            <i data-lucide="maximize-2" class="w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                        </div>
                        <div class="p-4 flex-1 flex flex-col relative">
                            <div class="text-gray-600 text-sm line-clamp-6 leading-relaxed">${data.summary}</div>
                            <div class="absolute inset-0 bg-blue-50/0 group-hover:bg-blue-50/10 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100 pointer-events-none">
                                <span class="bg-blue-600 text-white text-xs px-3 py-1 rounded-full shadow-lg transform translate-y-4 group-hover:translate-y-0 transition-transform">${t.clickToRead}</span>
                            </div>
                        </div>
                    `;
                    colDiv.appendChild(card);
                });
                grid.appendChild(colDiv);
            });
            lucide.createIcons();
        }

        function openModal(key) {
            if(isTourActive) stopSpeaking();

            const data = CONTENT[key][currentLang];
            const t = LANGUAGES[currentLang];
            const iconMap = { abstract:'file-text', intro:'info', fig1:'microscope', fig2:'activity', fig3:'zap', fig4:'activity', fig5:'microscope', fig6:'target', discussion:'book-open', references:'book' };

            // Remove highlight
            document.getElementById(`card-${key}`).classList.remove('tour-highlight');

            // Populate Modal
            document.getElementById('modal-title').innerText = data.title;
            document.getElementById('modal-icon-container').innerHTML = `<i data-lucide="${iconMap[key]}" class="w-5 h-5"></i>`;
            
            // Inject content + Image if applicable
            let htmlContent = data.text;
            if(key.startsWith('fig')) {
                htmlContent = getImgHtml(key) + htmlContent;
            }
            document.getElementById('modal-content').innerHTML = htmlContent;
            
            const modal = document.getElementById('modal-backdrop');
            modal.classList.remove('hidden');
            lucide.createIcons();

            // Tour Logic
            if(isTourActive) {
                // Find index of this key
                const keys = Object.keys(CONTENT);
                currentTourIndex = keys.indexOf(key);
                
                // Speak summary or clean text
                let textToSpeak = document.getElementById('modal-content').innerText;
                if(textToSpeak.length > 200) textToSpeak = textToSpeak.substring(0, 200); // Limit speech length
                speak(textToSpeak);
            }
        }

        function closeModal() {
            stopSpeaking();
            document.getElementById('modal-backdrop').classList.add('hidden');
            
            // Guide to next if tour is active
            if (isTourActive) {
                const keys = Object.keys(CONTENT);
                const nextIndex = currentTourIndex + 1;
                if (nextIndex < keys.length) {
                    const nextKey = keys[nextIndex];
                    const nextData = CONTENT[nextKey][currentLang];
                    guideToSection(nextKey, nextData.title);
                } else {
                    speak(LANGUAGES[currentLang].tourEnd);
                    stopTour();
                }
            }
        }

        // --- AUDIO TOUR ---
        function toggleTour() {
            isTourActive ? stopTour() : startTour();
        }

        function startTour() {
            isTourActive = true;
            const t = LANGUAGES[currentLang];
            const btn = document.getElementById('tour-btn');
            btn.classList.remove('bg-yellow-400', 'text-yellow-900');
            btn.classList.add('bg-red-500', 'text-white', 'hover:bg-red-600');
            document.getElementById('btn-tour').innerText = t.btnStopTour;

            speak(t.welcomeSpeech);
            highlightSection('abstract');
        }

        function stopTour() {
            isTourActive = false;
            stopSpeaking();
            const t = LANGUAGES[currentLang];
            const btn = document.getElementById('tour-btn');
            btn.classList.add('bg-yellow-400', 'text-yellow-900');
            btn.classList.remove('bg-red-500', 'text-white', 'hover:bg-red-600');
            document.getElementById('btn-tour').innerText = t.btnTour;
            document.querySelectorAll('.tour-highlight').forEach(el => el.classList.remove('tour-highlight'));
        }

        function guideToSection(id, title) {
            highlightSection(id);
            const t = LANGUAGES[currentLang];
            speak(`${t.nextStep} ${title}.`);
        }

        function highlightSection(id) {
            document.querySelectorAll('.tour-highlight').forEach(el => el.classList.remove('tour-highlight'));
            const card = document.getElementById(`card-${id}`);
            if(card) {
                card.classList.add('tour-highlight');
                card.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function speak(text) {
            if (synth.speaking) synth.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            
            // Map our lang codes to SpeechSynthesis Lang codes
            const langMap = { en: 'en-US', es: 'es-ES', de: 'de-DE', fr: 'fr-FR', zh: 'zh-CN', ja: 'ja-JP' };
            utterance.lang = langMap[currentLang];
            
            utterance.rate = 1.0; 
            synth.speak(utterance);
        }

        function stopSpeaking() {
            if (synth.speaking) synth.cancel();
        }

        // Init
        renderGrid();
    </script>
</body>
</html>










